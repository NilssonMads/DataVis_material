=== Visual Computing L05_FeaturesDescription.pdf pages=86
Visual Computing I: 
Interactive Computer Graphics and Vision
Features, Features Description and Feature Matching 
Stefanie Zollmann and Tobias Langlotz 

Last time.. 
â€¢ Luminance 
â€¢ Brightness 
â€¢ Contrast 
â€¢ Histogram equalization 
â€¢ Gamma 
â€¢ Color 
â€¢ Grayscale 
â€¢  Saturation 
â€¢  Dithering 
â€¢ Quantization 
â€¢ Random dither 
â€¢ Floyd-Steinberg
2D Image Processing 
3
â€¢ Linear ï¬ltering 
â€¢ Convolution 
â€¢ Blur & Sharpen 
â€¢ Edge detection 
â€¢ Image Pyramids 
â€¢ Non-linear ï¬ltering 
â€¢ Median 
â€¢ Image Feature Detection 
â€¢ Edges (e.g Canny Edge) 
â€¢ Corners (e.g. Shi-Tomasi, 
Harris Corner)  
â€¢ Blobs (e.g. Difference of 
Gaussians)
4
Original
 Edge verticalEdge horizontal
0 0 0
0 1 0
0 0 0
âˆ’ 1
2 0 1
2
âˆ’1 0 1
âˆ’ 1
2 0 1
2
âˆ’ 1
2 âˆ’1 âˆ’ 1
2
âˆ’0 0 0
1
2 1 1
2
Linear Filters and Image Convolutions 
Edge (Sobel Operator)
5
Original
Edge vertical/ 
horizontal
Edge horizontal/ 
vertical
0 0 0
0 1 0
0 0 0
âˆ’ 1
2 0 1
2
âˆ’1 0 1
âˆ’ 1
2 0 1
2
âˆ’ 1
2 âˆ’1 âˆ’ 1
2
âˆ’0 0 0
1
2 1 1
2
Linear Filters and Image Convolutions 
Edge (Sobel Operator)
6
Linear Filters and Image Convolutions 
â€¢ The short answer is: Yes, in pure mathematics and traditional signal processing, 
the deï¬nition of convolution involves ï¬‚ipping the kernel. However, also No because 
in computer vision, graphics, and deep learning, the operation we call 
"convolution" is actually cross-correlation, which does not ï¬‚ip the kernel.  
â€¢ There is a lot of subtlety and differences between the meanings of convolution and 
correlation in different ï¬elds (also Tobias did not know about that)
â€¢ Flipping operator in convolutions?!
â€¢ Luminance 
â€¢ Brightness 
â€¢ Contrast 
â€¢ Histogram equalization 
â€¢ Gamma 
â€¢ Color 
â€¢ Grayscale 
â€¢  Saturation 
â€¢  Dithering 
â€¢ Quantization 
â€¢ Random dither 
â€¢ Floyd-Steinberg
2D Image Processing 
7
â€¢ Linear ï¬ltering 
â€¢ Convolution 
â€¢ Blur & Sharpen 
â€¢ Edge detection 
â€¢ Image Pyramids 
â€¢ Non-linear ï¬ltering 
â€¢ Median 
â€¢ Image Feature Detection 
â€¢ Edges (e.g Canny Edge) 
â€¢ Corners (e.g. Shi-Tomasi, 
Harris Corner)  
â€¢ Blobs (e.g. Difference of 
Gaussians)
â€¢ Luminance 
â€¢ Brightness 
â€¢ Contrast 
â€¢ Histogram equalization 
â€¢ Gamma 
â€¢ Color 
â€¢ Grayscale 
â€¢  Saturation 
â€¢  Dithering 
â€¢ Quantization 
â€¢ Random dither 
â€¢ Floyd-Steinberg
2D Image Processing 
8
â€¢ Linear ï¬ltering 
â€¢ Convolution 
â€¢ Blur & Sharpen 
â€¢ Edge detection 
â€¢ Image Pyramids 
â€¢ Non-linear ï¬ltering 
â€¢ Median 
â€¢ Image Feature Detection 
â€¢ Edges (e.g Canny Edge) 
â€¢ Corners (e.g. Shi-Tomasi, 
Harris Corner)  
â€¢ Blobs (e.g. Difference of 
Gaussians)
Image Filters - 
Non-Linear Filters 
Non-Linear Filters
10
â€¢ Not all ï¬lters are implemented as 
convolution operations 
â€¢ E.g. Median ï¬lter 
â€¢ Take a local neighbourhood (e.g. a 
 or window) 
â€¢ Sort the pixel values 
â€¢ Use the middle value as the result 
â€¢ Has a smoothing effect, but 
preserves sharp edges
3 Ã— 3 5 Ã— 5Â 
MedianOriginal

=== VisualComputingL06_Homographies.pdf pages=48
Visual Computing I:â€¨ 
Interactive Computer Graphics and Vision
Feature Matching, Image Stitching, Homographies Stefanie Zollmann and Tobias Langlotz 

8
How to find correspondences?

SIFT - Feature matching
10
SIFT -  Matching
â€¢ SIFT descriptor 128 values 
â€¢ Usually these are bytes 
â€¢ Computing the distance between 
features: 
 
â€¢ 128 subtractions 
â€¢ 128 multiplications 
â€¢ 127 additions 
â€¢ 1 square root (optional)
ğ‘‘ = (ğ‘1 âˆ’ ğ‘1)
2
+ (ğ‘2 âˆ’ ğ‘2)
2
+ â€¦

11
SIFT -  Matching
â€¢ SIFT descriptor 128 values 
â€¢ Usually these are bytes 
â€¢ Computing the distance between 
features: 
 
â€¢ 128 subtractions 
â€¢ 128 multiplications 
â€¢ 127 additions 
â€¢ 1 square root (optional)
ğ‘‘ = (ğ‘1 âˆ’ ğ‘1)
2
+ (ğ‘2 âˆ’ ğ‘2)
2
+ â€¦
12
SIFT -  Matching
â€¢ SIFT descriptor 128 values 
â€¢ Usually these are bytes 
â€¢ Computing the distance between 
features: 
 
â€¢ 128 subtractions 
â€¢ 128 multiplications 
â€¢ 127 additions 
â€¢ 1 square root (optional)
ğ‘‘ = (ğ‘1 âˆ’ ğ‘1)
2
+ (ğ‘2 âˆ’ ğ‘2)
2
+ â€¦
â€¢ Suppose we have 10,000 features 
in each image 
â€¢ Brute force method â€“ find 
distance for each pair 
â€¢ Match is smallest distance 
â€¢ Matching one feature: 
 operations 
â€¢ Matching all features: 
 ops
3,840, 000
38,400, 000,000
13
SIFT -  Approximate Nearest Neighbours
â€¢ Split space into smaller regions 
â€¢ Each feature lies in one region 
â€¢ Only look for matches in same region 
â€¢ Might not find nearest match (why?) 
â€¢ Uniform subdivision: 
â€¢ Divide space into a regular grid 
â€¢ 10 divisions on 2-D grid â€“ 100 
regions 
â€¢ 10 divisions on 128-D grid â€“ 10128 
Example for 2D Feature Vector
14
SIFT -  Quadtrees, Octrees, etc. 
â€¢ Recursively split space in half along 
each dimension 
â€¢ Stop splitting when: 
â€¢ Some max depth is reached 
â€¢ Only a few items in the cell 
â€¢ 2-D gives a quadtree 
â€¢ 3-D gives an octree 
â€¢ 128-D: : still too big -> 2128 ~ 1038
15
SIFT -  K-D Trees
â€¢ k-dimensional tree 
â€¢ Choose an axis and split along it 
â€¢ Then take each half and repeat 
â€¢ Stop when: 
â€¢ Only a few items in the region 
â€¢ Reached some maximum depth 
â€¢ How to choose splits? 
â€¢ Axis â€“ next, random, greatest 
spread? 
â€¢ Splitting point â€“ middle or even split?
16
SIFT -  K-D Trees

=== VisualComputingL07.pdf pages=48
Visual Computing I:â€¨ 
Interactive Computer Graphics and Vision
Homographies, RANSAC, Blending Stefanie Zollmann and Tobias Langlotz 
[
???
???
???]
Last time.. 
3
How to find correspondences?

4
Image Stitching Process
â€¢ Four main stages: 
1.Detect features in each image 
2.Match features between images 
3.Estimate a transform 
4.Warp one image to the other 
â€¢ Stitching only works if: 
â€¢ The scene is (almost) planar, or 
â€¢ The camera only (mostly) rotates
Features 1
Image 1
Features 2
Image 2
Correspondences
Transform Matrix
Stitched Image
Feature Matching
Compute Transform
Warp & Composite
Feature Detection
5
Homographies and Image Stitching
â€¢ To stitch an image: 
â€¢ Need to warp images to align 
â€¢ This warping is a homography 
â€¢ How to ï¬nd the homography? 
â€¢ If a feature at (u,v) in one image  matches to  (uâ€™,vâ€™) in the other, then
[
ğ‘¢â€² 
ğ‘£â€² 
1 ] â‰¡
h11 h12 h13
h21 h22 h23
h31 h32 h33
[
ğ‘¢
ğ‘£
1]

Demoâ€¦ 
7
Solving from Point Correspondences
â€¢ Suppose we have  matching points between two images 
 
â€¢ Each pair gives us information about the homography,  
 
â€¢ The equivalence makes things difï¬cult: 
â€¢ Everything has an unknown scale factor associated with it 
â€¢ Canâ€™t solve things uniquely â€“ if  is a solution, so is 
ğ‘›
(ğ‘¢1,ğ‘£1) â†”(ğ‘¢â€² 1,ğ‘£â€² 1),(ğ‘¢2,ğ‘£2) â†”(ğ‘¢â€² 2,ğ‘£â€² 2),â€¦ (ğ‘¢ğ‘›,ğ‘£ğ‘›) â†”(ğ‘¢â€² ğ‘›,ğ‘£â€² ğ‘›)
H
xâ€² ğ‘– â‰¡ Hxğ‘–
H
ğ‘˜H, Â âˆ€ğ‘˜ â‰  0
8
Solving from Point Correspondences
â€¢ Remember: We want to use the relationship:  where 
â€¢ x,xâ€² are homogeneous 2D points (3Ã—1), 
â€¢ H is the homography (3Ã—3), 
â€¢ Î» is an unknown scale factor 
â€¢ The problem: Î» is diï¬€erent for each correspondence, so itâ€™s not something we can just solve for 
globally
â€¢ The trick: Equation   means the two vectors xâ€² and Hx are parallel in 3D (homogeneous 
coordinate space) -> In other words, one is a scaled version of the other
â€¢ This means their cross product is 0:  
â€¢ No  -> no worry -> Each correspondence provides 2 independent linear equations in the entries of H 
â€¢ Need  at least 4 correspondences to solve for H (8 dof)
xâ€² = Î»Hx
xâ€² = Î»Hx
xâ€² Ã— (Hx) = 0
Î»
9
Lets build the equation system 
[
ğ‘¢â€² 
ğ‘£â€² 
1 ] Ã—
h1 h2 h3
h4 h5 h6
h7 h8 h9
[
ğ‘¢
ğ‘£
1] = [
0
0
0]
[
uâ€² 
vâ€² 
1] Ã—
h1u + h2v + h3
h4u + h5v + h6
h7u + h8v + h9
= [
0
0
0]
vâ€² (h7u + h8v + h9) âˆ’ (h4 + h5 + h6) = 0
(h1u + h2v + h3) âˆ’ uâ€² (h7y + h8v + h9) = 0
uâ€² (h4u + h5v + h6) âˆ’ vâ€² (h1u + h2v + h3) = 0
vâ€² (h7u + h8v + h9) âˆ’ (h4 + h5 + h6)
(h1u + h2v + h3) âˆ’ uâ€² (h7y + h8v + h9)
uâ€² (h4u + h5v + h6) âˆ’ vâ€² (h1u + h2v + h3)
= [
0
0
0]
x Ã— y =
x1
x2
x3
Ã—
y1
y2
y3
=
x2y3 âˆ’ x3y2
x3y1 âˆ’ x1y3
x1y2 âˆ’ x2y1
Remember: cross product
a11 a12 a13
a21 a22 a23
a31 a32 a33
x1
x2
x3
=
a11x1 + a12 x2 + a13x3
a21x1 + a22 x2 + a23x3
a31x1 + a32 x2 + a33x3
Remember: Matrix/Vector  
Multiplication
10
Finding the Homography
 
â€¢ This looks like three equations, but not independent 
â€¢ Use the ï¬rst two (for symmetry) and rewrite as 
ğ‘£â€² ğ‘–(h7ğ‘¢ğ‘– + h8ğ‘£ğ‘– + h9) âˆ’ (h4ğ‘¢ğ‘– + h5ğ‘£ğ‘– + h6)
(h1ğ‘¢ğ‘– + h2ğ‘£ğ‘– + h3) âˆ’ ğ‘¢â€² ğ‘–(h7ğ‘¢ğ‘– + h8ğ‘£ğ‘– + h9)
ğ‘¢â€² ğ‘–(h4ğ‘¢ğ‘– + h5ğ‘£ğ‘– + h6) âˆ’ ğ‘£â€² ğ‘–(h1ğ‘¢ğ‘– + h2ğ‘£ğ‘– + h3)
= [
0
0
0]
[
0 0 0 âˆ’ğ‘¢ğ‘– âˆ’ğ‘£ğ‘– âˆ’1 ğ‘¢ğ‘–ğ‘£â€² ğ‘– ğ‘£ğ‘–ğ‘£â€² ğ‘– ğ‘£â€² ğ‘–
ğ‘¢ğ‘– ğ‘£ğ‘– 1 0 0 0 âˆ’ğ‘¢ğ‘–ğ‘¢â€² ğ‘– âˆ’ğ‘£ğ‘–ğ‘¢â€² ğ‘– âˆ’ğ‘¢â€² ğ‘–]
h1
h2
â‹®
h9
= [
0
0]

